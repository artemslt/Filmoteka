{"mappings":"6mBAsBA,IAAAA,EACAC,E,iJArBA,IAAIC,EAAU,GAoBdF,EAlBA,SAAkBG,GAGhB,IAFA,IAAIC,EAAOC,OAAOD,KAAKD,GAEdG,EAAI,EAAGA,EAAIF,EAAKG,OAAQD,IAC/BJ,EAAQE,EAAKE,IAAMH,EAAMC,EAAKE,G,EAelCL,EAXA,SAAiBO,GACf,IAAIC,EAAWP,EAAQM,GAEvB,GAAgB,MAAZC,EACF,MAAM,IAAIC,MAAM,oCAAsCF,GAGxD,OAAOC,C,KCnBTE,EAAA,SAAAC,SAA8CC,KAAKC,MAAM,+LCAzD,IAAAC,EAAAJ,EAAA,SCCAK,EAAAL,EAAA,S,mEAcA,MAAMM,iBAAEC,EAAgBC,eAAEC,EAAcC,SAAEC,GAAaP,EAAAQ,KAGjDC,EAAmB,iBACnBC,GAgGiBC,EAhGOC,SAASC,KAAKC,cAiGvB,KACV,EAELH,EAAc,IACT,EAEF,EAPT,IAAuBA,EA/FvB,IAAII,EAAeC,EAAAC,aA2BnB,SAASC,EAAyBC,GAC5BH,EAAAI,gBAAgBC,KAAKL,EAAAM,SAO3BC,eAAkCJ,GAChC,MAAMK,QA6BRD,eAAyCJ,GACvC,MAAMM,EAmBR,SAAyBN,GAGvB,OAFiBH,EAAAI,gBAAgBC,KAAKL,EAAAM,SAASP,GAE/BW,QAAO,CAACC,EAAOC,KAC7B,GAAIA,GAASlB,GAAWS,EAAO,IAAMS,EAAQlB,EAAUS,EACrD,OAAOQ,CAAK,G,CAxBSE,CAAgBV,GAEzC,GAAgC,IAA5BM,EAAiBjC,OACnB,OAAO,KAGT,MAAMsC,EAAgBL,EAAiBM,KAAIC,IAC3B,EAAA/B,EAAAgC,kBAAiBD,KAIjC,IACE,MAAME,QAAeC,QAAQC,IAAIN,GACjC,OAAO,EAAAO,EAAAC,SAAaJ,E,CACpB,MAAOK,GACPC,QAAQC,IAAIF,EAAEG,Q,EA7CKC,CAA0BxB,GAE/C,GAAIK,EAAQ,CACVjB,EAASqC,UAAYpB,EAGrB,MAAMqB,EAAM7B,EAAAI,gBAAgBC,KAAKL,EAAAM,SAASP,GACpC+B,EAAaC,KAAKC,KAAKH,EAAIrD,OAASkB,IAC1C,EAAAuC,EAAAC,kBAAiB/B,EAAM2B,GAEvBlC,SACGuC,iBAAiB,qBACjBC,SAAQC,GAAQA,EAAKC,iBAAiB,QAASC,EAAAC,kB,MAElDC,G,CArBAC,CAAmBvC,GAEnBsC,G,CAuBJ,SAASA,IACH1C,IAAiBC,EAAAC,aAIjBF,IAAiBC,EAAA2C,aACnBpD,EAASqC,UAAY,wBAJrBrC,EAASqC,UAAY,oB,CArDzB1B,EAAyB,GAGzBf,EAAiBmD,iBAAiB,SAIlC,WAgGOnD,EAAiByD,UAAUC,SAASpD,KACvCN,EAAiByD,UAAUE,IAAIrD,GAC/BJ,EAAeuD,UAAUG,OAAOtD,IA/FlCM,EAAeC,EAAAC,aAEfC,EAAyB,E,IAR3Bb,EAAeiD,iBAAiB,SAWhC,WA+FOjD,EAAeuD,UAAUC,SAASpD,KACrCJ,EAAeuD,UAAUE,IAAIrD,GAC7BN,EAAiByD,UAAUG,OAAOtD,IA9FpCM,EAAeC,EAAA2C,WAEfzC,EAAyB,E,4FD/B3B,EAAA8C,EAAAC,cAAa,CAACC,EAAAC,sBAAuB,CAACD,EAAAE,yBACtClD,EAAyB,GAEzBlB,EAAAQ,KAAK6D,cAAcf,iBAAiB,SAASf,IACtCA,EAAE+B,OAAOC,QAAQpD,OACtBqD,OAAOC,SAAS,CACdC,IAAK,EACLC,KAAM,IAERzD,GAA0BqB,EAAE+B,OAAOC,QAAQpD,MAAK,G","sources":["node_modules/@parcel/runtime-js/lib/helpers/bundle-manifest.js","node_modules/@parcel/runtime-js/lib/runtime-299e6a58101f5c60.js","src/js/library.js","src/js/library-main.js"],"sourcesContent":["\"use strict\";\n\nvar mapping = {};\n\nfunction register(pairs) {\n  var keys = Object.keys(pairs);\n\n  for (var i = 0; i < keys.length; i++) {\n    mapping[keys[i]] = pairs[keys[i]];\n  }\n}\n\nfunction resolve(id) {\n  var resolved = mapping[id];\n\n  if (resolved == null) {\n    throw new Error('Could not resolve bundle with id ' + id);\n  }\n\n  return resolved;\n}\n\nmodule.exports.register = register;\nmodule.exports.resolve = resolve;","require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"jNRdE\\\":\\\"library.fc360a4b.js\\\",\\\"ee16w\\\":\\\"sprite.b4d5ffca.svg\\\",\\\"dmc2h\\\":\\\"index.953b1bf1.css\\\",\\\"cSIeN\\\":\\\"index.741e1203.js\\\"}\"));","import { refs } from './constants/refs';\nimport { renderLibraryMainContent } from './library-main';\nimport './modalCard';\nimport './modalAbout';\nimport './features/upToTop/upToTop';\nimport './features/auth/authModalWindowContent';\nimport { authObserver } from './api/firebase/api';\nimport {\n  showAuthorisedFields,\n  showUnauthorisedFields,\n} from './features/auth/authModalWindowContent';\n\nauthObserver([showAuthorisedFields], [showUnauthorisedFields]);\nrenderLibraryMainContent(1);\n\nrefs.paginationBox.addEventListener('click', e => {\n  if (!e.target.dataset.page) return;\n  window.scrollTo({\n    top: 0,\n    left: 0,\n  });\n  renderLibraryMainContent(+e.target.dataset.page);\n});\n\nimport './features/theme-switcher/theme-switcher';\n","// imports\nimport { getMoviesDetails } from './api/moviedb/getMoviesDetails';\nimport createMarkUp from '../templates/film-cards.hbs';\nimport { refs } from './constants/refs';\nimport {\n  storage,\n  STORAGE,\n  ANON_WATCHED,\n  ANON_QUEUE,\n  localStorageAPI,\n} from './constants/storage';\nimport { createPagination } from './pagination/createPagination';\nimport { onFilmCardClick } from './onFilmCardClick';\n\n// references\nconst { headerWatchedBtn, headerQueueBtn, mainList } = refs;\n\n// variables\nconst ACCENT_BTN_CLASS = 'button--accent';\nconst perPage = choisePerPage(document.body.clientWidth);\nlet libraryQuery = ANON_WATCHED;\n\n// preorders\nrenderLibraryMainContent(1);\n\n// event listeners\nheaderWatchedBtn.addEventListener('click', onClickWatched);\nheaderQueueBtn.addEventListener('click', onClickQueue);\n\n// event listeners functions\nfunction onClickWatched() {\n  accentWatchedBtn();\n\n  libraryQuery = ANON_WATCHED;\n\n  renderLibraryMainContent(1);\n}\n\nfunction onClickQueue() {\n  accentQueueBtn();\n\n  libraryQuery = ANON_QUEUE;\n\n  renderLibraryMainContent(1);\n}\n\n// functions helpers\nfunction renderLibraryMainContent(page) {\n  if (localStorageAPI.load(STORAGE)) {\n    renderLibraryCards(page);\n  } else {\n    renderEmptyLibrary();\n  }\n}\n\nasync function renderLibraryCards(page) {\n  const markup = await createLibraryCardsdMarkup(page);\n\n  if (markup) {\n    mainList.innerHTML = markup;\n    // place for pagination function and add event listeners to film's cards\n    // pagination\n    const arr = localStorageAPI.load(STORAGE)[libraryQuery];\n    const totalPages = Math.ceil(arr.length / perPage);\n    createPagination(page, totalPages);\n    // event listeners\n    document\n      .querySelectorAll('[data-modal-open]')\n      .forEach(card => card.addEventListener('click', onFilmCardClick));\n  } else {\n    renderEmptyLibrary();\n  }\n}\n\nfunction renderEmptyLibrary() {\n  if (libraryQuery === ANON_WATCHED) {\n    mainList.innerHTML = 'Nothing wathed yet';\n    return;\n  }\n  if (libraryQuery === ANON_QUEUE) {\n    mainList.innerHTML = 'Nothing in queue yet';\n    return;\n  }\n}\n\nasync function createLibraryCardsdMarkup(page) {\n  const filteredCardsArr = filterCardsdArr(page);\n\n  if (filteredCardsArr.length === 0) {\n    return null;\n  }\n\n  const moviePromises = filteredCardsArr.map(el => {\n    const movie = getMoviesDetails(el);\n    return movie;\n  });\n\n  try {\n    const movies = await Promise.all(moviePromises);\n    return createMarkUp(movies);\n  } catch (e) {\n    console.log(e.message);\n  }\n}\n\nfunction filterCardsdArr(page) {\n  const cardsArr = localStorageAPI.load(STORAGE)[libraryQuery];\n\n  return cardsArr.filter((value, index) => {\n    if (index >= perPage * (page - 1) && index < perPage * page) {\n      return value;\n    }\n  });\n}\n\nfunction choisePerPage(screenWidth) {\n  if (screenWidth >= 1280) {\n    return 9;\n  }\n  if (screenWidth < 768) {\n    return 4;\n  }\n  return 8;\n}\n\nfunction accentWatchedBtn() {\n  if (!headerWatchedBtn.classList.contains(ACCENT_BTN_CLASS)) {\n    headerWatchedBtn.classList.add(ACCENT_BTN_CLASS);\n    headerQueueBtn.classList.remove(ACCENT_BTN_CLASS);\n  }\n}\n\nfunction accentQueueBtn() {\n  if (!headerQueueBtn.classList.contains(ACCENT_BTN_CLASS)) {\n    headerQueueBtn.classList.add(ACCENT_BTN_CLASS);\n    headerWatchedBtn.classList.remove(ACCENT_BTN_CLASS);\n  }\n}\n\n// exports\nexport { renderLibraryMainContent };\n"],"names":["$0380ce8f1f064ccc$export$6503ec6e8aabbaf","$0380ce8f1f064ccc$export$f7ad0328861e2f03","$0380ce8f1f064ccc$var$mapping","pairs","keys","Object","i","length","id","resolved","Error","parcelRequire","register","JSON","parse","$5DkEY","$9fz8o","headerWatchedBtn","$d30d6e4045cb7863$var$headerWatchedBtn","headerQueueBtn","$d30d6e4045cb7863$var$headerQueueBtn","mainList","$d30d6e4045cb7863$var$mainList","refs","$d30d6e4045cb7863$var$ACCENT_BTN_CLASS","$d30d6e4045cb7863$var$perPage","screenWidth","document","body","clientWidth","$d30d6e4045cb7863$var$libraryQuery","$c10SZ","ANON_WATCHED","$d30d6e4045cb7863$export$243b4d1206135091","page","localStorageAPI","load","STORAGE","async","markup","filteredCardsArr","filter","value","index","$d30d6e4045cb7863$var$filterCardsdArr","moviePromises","map","el","getMoviesDetails","movies","Promise","all","$1ZLLT","default","e","console","log","message","$d30d6e4045cb7863$var$createLibraryCardsdMarkup","innerHTML","arr","totalPages","Math","ceil","$fZtXX","createPagination","querySelectorAll","forEach","card","addEventListener","$5QZZU","onFilmCardClick","$d30d6e4045cb7863$var$renderEmptyLibrary","$d30d6e4045cb7863$var$renderLibraryCards","ANON_QUEUE","classList","contains","add","remove","$6bgo7","authObserver","$fkmi9","showAuthorisedFields","showUnauthorisedFields","paginationBox","target","dataset","window","scrollTo","top","left"],"version":3,"file":"library.fc360a4b.js.map"}